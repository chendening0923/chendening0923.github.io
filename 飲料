<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<title>æˆ‘çš„é£²æ–™è©•æ¯”æœ¬ï½œDrink Review</title>
<!
-æ‰‹å¯«ï¼‹åœ“æ½¤å­—é«” -->
<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Nunito:wght@300;400;600;800&display=swap&quot; rel="stylesheet">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
:root {
--bg-grad-1: #ffe4f1;
--bg-grad-2: #e9fff5;
--card-bg: #ffffff;
--accent-pink: #ff9ac4;
--accent-green: #7ac9a4;
--accent-yellow: #ffd77a;
--text-main: #433b4a;
--text-light: #7b6f87;
--border-soft: #f7cfe4;
--shadow-soft: 0 12px 30px rgba(255, 155, 196, 0.25);
--radius-big: 18px;
--radius-small: 10px;
}
* {
box-sizing: border-box;
}

body {
margin: 0;
min-height: 100vh;
font-family: "Nunito", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
background: linear-gradient(135deg, var(--bg-grad-1), var(--bg-grad-2));
color: var(--text-main);
display: flex;
justify-content: center;
padding: 24px 12px 40px;
}

.app {
width: 100%;
max-width: 1100px;
background: rgba(255, 255, 255, 0.85);
box-shadow: 0 18px 40px rgba(190, 144, 212, 0.25);
border-radius: 26px;
padding: 22px 18px 28px;
backdrop-filter: blur(12px);
border: 1.2px solid rgba(255, 255, 255, 0.9);
}

@media (min-width: 768px) {
.app {
padding: 28px 32px 32px;
}
}

.app-header {
display: flex;
gap: 16px;
align-items: center;
margin-bottom: 18px;
}

.logo-circle {
width: 60px;
height: 60px;
border-radius: 50%;
background: radial-gradient(circle at 30% 20%, #ffeaf3, #ff9ac4);
box-shadow: 0 8px 20px rgba(255, 121, 166, 0.35);
display: flex;
align-items: center;
justify-content: center;
position: relative;
overflow: hidden;
}

.logo-straw {
position: absolute;
width: 7px;
height: 46px;
background: linear-gradient(180deg, #fff, #ffd2e7);
border-radius: 4px;
transform: rotate(18deg);
top: -2px;
right: 14px;
box-shadow: 0 0 0 1px rgba(255,255,255,0.8);
}

.logo-cup {
width: 30px;
height: 34px;
border-radius: 12px 12px 14px 14px;
background: linear-gradient(160deg, #fff5fb, #ffc2dd);
border: 1.4px solid rgba(255, 255, 255, 0.9);
box-shadow: 0 4px 10px rgba(198, 93, 143, 0.6);
display: flex;
align-items: center;
justify-content: center;
position: relative;
overflow: hidden;
}

.logo-pearls {
position: absolute;
bottom: 4px;
display: flex;
gap: 3px;
}

.logo-pearls span {
width: 6px;
height: 6px;
border-radius: 50%;
background: rgba(118, 81, 63, 0.95);
}

.logo-text-main {
font-family: "Patrick Hand", system-ui;
font-size: 24px;
line-height: 1.1;
}

.logo-text-sub {
font-size: 12px;
color: var(--text-light);
margin-top: 4px;
}

.chip {
display: inline-flex;
align-items: center;
gap: 6px;
padding: 3px 9px;
border-radius: 999px;
background: rgba(255, 255, 255, 0.9);
font-size: 11px;
color: var(--accent-pink);
border: 1px dashed rgba(255, 154, 196, 0.6);
}

.chip-dot {
width: 6px;
height: 6px;
border-radius: 50%;
background: linear-gradient(135deg, var(--accent-pink), var(--accent-yellow));
}

/* layout */
.layout {
display: grid;
grid-template-columns: 1.1fr 1.3fr;
gap: 18px;
}

@media (max-width: 880px) {
.layout {
grid-template-columns: 1fr;
}
}

/* panel æ¨£å¼ */
.panel {
background: linear-gradient(135deg, #ffffff, #fff6fb);
border-radius: 22px;
padding: 16px 16px 18px;
box-shadow: var(--shadow-soft);
border: 1.2px solid var(--border-soft);
position: relative;
overflow: hidden;
}

.panel::before {
content: "";
position: absolute;
width: 120px;
height: 120px;
border-radius: 40% 60% 65% 35%;
background: radial-gradient(circle at 30% 20%, rgba(255, 226, 242, 0.9), rgba(255, 154, 196, 0));
top: -60px;
right: -40px;
opacity: 0.7;
pointer-events: none;
}

.panel-title {
font-size: 16px;
font-weight: 800;
margin-bottom: 6px;
display: flex;
align-items: center;
gap: 8px;
}

.panel-subtitle {
font-size: 12px;
color: var(--text-light);
margin-bottom: 12px;
}

/* è¡¨å–® */
.form-grid {
display: grid;
grid-template-columns: repeat(2, minmax(0, 1fr));
gap: 10px 12px;
position: relative;
z-index: 1;
}

@media (max-width: 640px) {
.form-grid {
grid-template-columns: 1fr;
}
}

.form-group {
display: flex;
flex-direction: column;
gap: 3px;
font-size: 13px;
}

.form-label {
display: flex;
align-items: center;
justify-content: space-between;
font-weight: 600;
}

.label-tag {
font-size: 11px;
color: var(--accent-pink);
opacity: 0.9;
}

input[type="text"],
input[type="number"],
select,
textarea {
border-radius: 999px;
border: 1.2px solid rgba(255, 188, 214, 0.85);
padding: 7px 11px;
font-size: 13px;
font-family: inherit;
outline: none;
background: rgba(255, 255, 255, 0.9);
transition: all 0.18s ease;
}

textarea {
border-radius: 14px;
min-height: 60px;
resize: vertical;
}

input:focus,
select:focus,
textarea:focus {
border-color: var(--accent-pink);
box-shadow: 0 0 0 1.5px rgba(255, 154, 196, 0.35);
background: #fff;
}

.range-wrapper {
display: flex;
align-items: center;
gap: 6px;
}

input[type="range"] {
-webkit-appearance: none;
appearance: none;
width: 100%;
height: 6px;
border-radius: 999px;
background: linear-gradient(90deg, #ffe1f0, #ffd77a);
outline: none;
}

input[type="range"]::-webkit-slider-thumb {
-webkit-appearance: none;
appearance: none;
width: 16px;
height: 16px;
border-radius: 50%;
background: #fff;
border: 2px solid var(--accent-pink);
box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
cursor: pointer;
}

.range-value {
min-width: 20px;
text-align: right;
font-size: 12px;
color: var(--text-light);
}

.form-row-span {
grid-column: 1 / -1;
}

.hint {
font-size: 11px;
color: var(--text-light);
margin-top: -4px;
}

.btn-add {
margin-top: 8px;
grid-column: 1 / -1;
align-self: flex-end;
justify-self: flex-end;
border: none;
border-radius: 999px;
padding: 8px 18px;
font-size: 13px;
font-weight: 700;
background: linear-gradient(135deg, var(--accent-pink), var(--accent-yellow));
color: #fff;
display: inline-flex;
align-items: center;
gap: 6px;
cursor: pointer;
box-shadow: 0 10px 20px rgba(255, 154, 196, 0.45);
transition: transform 0.12s ease, box-shadow 0.12s ease;
}

.btn-add span.icon {
font-size: 16px;
margin-top: -1px;
}

.btn-add:hover {
transform: translateY(-1px);
box-shadow: 0 12px 28px rgba(255, 154, 196, 0.55);
}

.btn-add:active {
transform: translateY(1px);
box-shadow: 0 6px 14px rgba(255, 154, 196, 0.4);
}

.badges-row {
display: flex;
flex-wrap: wrap;
gap: 6px;
margin-top: 4px;
}

.badge {
font-size: 11px;
padding: 2px 7px;
border-radius: 999px;
border: 1px dashed rgba(255, 188, 214, 0.8);
background: rgba(255, 255, 255, 0.8);
color: var(--accent-green);
}

/* åˆ—è¡¨å€ */
.toolbar {
display: flex;
flex-wrap: wrap;
gap: 8px;
justify-content: space-between;
align-items: center;
margin-bottom: 10px;
position: relative;
z-index: 1;
}

.toolbar-left {
display: flex;
gap: 6px;
align-items: center;
flex-wrap: wrap;
}

.toolbar-title {
font-size: 14px;
font-weight: 700;
display: flex;
align-items: center;
gap: 6px;
}

.pill-count {
font-size: 11px;
padding: 2px 8px;
border-radius: 999px;
background: rgba(255, 255, 255, 0.8);
border: 1px solid rgba(255, 188, 214, 0.9);
color: var(--accent-pink);
}

.toolbar-right {
display: flex;
flex-wrap: wrap;
gap: 8px;
align-items: center;
}

.input-small {
font-size: 12px;
padding: 5px 10px;
border-radius: 999px;
border: 1px solid rgba(255, 188, 214, 0.85);
background: rgba(255, 255, 255, 0.9);
outline: none;
}

.select-small {
font-size: 12px;
padding: 5px 10px;
border-radius: 999px;
border: 1px solid rgba(255, 188, 214, 0.85);
background: rgba(255, 255, 255, 0.9);
outline: none;
}

.drink-list {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
gap: 10px;
position: relative;
z-index: 1;
max-height: 520px;
overflow-y: auto;
padding-right: 4px;
}

.drink-card {
background: var(--card-bg);
border-radius: var(--radius-big);
padding: 10px 11px 11px;
box-shadow: 0 8px 20px rgba(175, 146, 198, 0.18);
border: 1px solid rgba(255, 220, 237, 0.9);
position: relative;
overflow: hidden;
}

.drink-card::before {
content: "";
position: absolute;
width: 80px;
height: 80px;
background: radial-gradient(circle at 0 0, rgba(255, 215, 122, 0.9), rgba(255, 215, 122, 0));
right: -30px;
top: -30px;
opacity: 0.7;
pointer-events: none;
}

.drink-header {
display: flex;
justify-content: space-between;
gap: 6px;
margin-bottom: 6px;
align-items: flex-start;
}

.drink-store {
font-size: 13px;
font-weight: 800;
display: flex;
flex-direction: column;
gap: 2px;
}

.drink-name {
font-size: 12px;
color: var(--text-light);
}

.score-badge {
min-width: 44px;
height: 44px;
border-radius: 16px;
background: radial-gradient(circle at 30% 10%, #fff7fb, #ff9ac4);
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
font-weight: 800;
color: #fff;
font-size: 16px;
box-shadow: 0 6px 14px rgba(255, 154, 196, 0.6);
}

.score-badge small {
font-size: 9px;
opacity: 0.95;
margin-top: -2px;
}

.drink-tags {
display: flex;
flex-wrap: wrap;
gap: 4px;
margin-bottom: 4px;
}

.tag {
font-size: 10px;
padding: 2px 6px;
border-radius: 999px;
background: rgba(122, 201, 164, 0.09);
color: var(--accent-green);
border: 1px solid rgba(122, 201, 164, 0.45);
}

.tag-price {
background: rgba(255, 215, 122, 0.1);
color: #c89519;
border-color: rgba(255, 215, 122, 0.75);
}

.meter-row {
display: grid;
grid-template-columns: repeat(3, minmax(0, 1fr));
gap: 4px;
margin-bottom: 4px;
}

.meter {
display: flex;
flex-direction: column;
gap: 2px;
}

.meter-label {
font-size: 10px;
color: var(--text-light);
display: flex;
justify-content: space-between;
}

.meter-bar {
width: 100%;
height: 6px;
border-radius: 999px;
background: #f6eefa;
overflow: hidden;
position: relative;
}

.meter-fill {
position: absolute;
height: 100%;
left: 0;
top: 0;
border-radius: 999px;
background: linear-gradient(90deg, var(--accent-green), var(--accent-pink));
}

.pros-cons {
font-size: 11px;
margin-top: 4px;
border-top: 1px dashed rgba(244, 205, 227, 0.8);
padding-top: 4px;
display: flex;
flex-direction: column;
gap: 2px;
}

.pros-cons strong {
font-weight: 700;
font-size: 11px;
}

.empty-state {
font-size: 12px;
color: var(--text-light);
text-align: center;
margin-top: 12px;
}

.footer-note {
margin-top: 10px;
font-size: 10px;
color: var(--text-light);
text-align: right;
}
</style>
</head>
<body>
<div class="app">
<header class="app-header">
<div class="logo-circle">
<div class="logo-straw"></div>
<div class="logo-cup">
<div class="logo-pearls">
<span></span><span></span><span></span>
</div>
</div>
</div>
<div>
<div class="logo-text-main">æˆ‘çš„é£²æ–™è©•æ¯”æœ¬</div>
<div class="logo-text-sub">è¨˜éŒ„æ¯ä¸€æ¯ç™‚ç™’é£²æ–™çš„åˆ†æ•¸ã€å„ªé»èˆ‡å°ç¼ºé»</div>
<div class="badges-row">
<div class="chip">
<span class="chip-dot"></span>
æ‰‹ç¹ª X ç²‰è‰²ç™‚ç™’é¢¨
</div>
<span class="badge">æ”¯æ´æœ¬æ©Ÿå„²å­˜ï¼ˆLocalStorageï¼‰</span>
</div>
</div>
</header>

<div class="layout">
<!
-å·¦å´ï¼šè¼¸å…¥è¡¨å–® -->
<section class="panel">
<div class="panel-title">â• æ–°å¢ä¸€æ¯é£²æ–™</div>
<div class="panel-subtitle">å¡«å¯«ä¸‹é¢è³‡è¨Šï¼Œå¹«ä»Šå¤©é€™æ¯é£²æ–™ç•™ä¸‹å°ˆå±¬è©•èªèˆ‡åˆ†æ•¸ã€‚</div>
<form id="drinkForm" class="form-grid">
<div class="form-group">
<label class="form-label">
åº—å®¶åç¨±
<span class="label-tag">å¿…å¡«</span>
</label>
<input type="text" id="store" placeholder="ä¾‹ï¼šæ¸…å¿ƒç¦å…¨ã€CoCoã€è¿·å®¢å¤â€¦" required />
</div>

<div class="form-group">
<label class="form-label">
é£²æ–™åç¨±
<span class="label-tag">å¿…å¡«</span>
</label>
<input type="text" id="drinkName" placeholder="ä¾‹ï¼šç´…èŒ¶æ‹¿éµã€çç å¥¶èŒ¶â€¦" required />
</div>

<div class="form-group">
<label class="form-label">
ç¸½åˆ†ï¼ˆ1â€“10ï¼‰
<span class="label-tag">æ•´é«”æ„Ÿå—</span>
</label>
<div class="range-wrapper">
<input type="range" id="totalScore" min="1" max="10" value="8" />
<div class="range-value" id="totalScoreValue">8</div>
</div>
</div>

<div class="form-group">
<label class="form-label">
åƒ¹æ ¼ï¼ˆå…ƒï¼‰
<span class="label-tag">å«åŠ æ–™å¾Œ</span>
</label>
<input type="number" id="price" min="0" step="1" placeholder="ä¾‹ï¼š55" />
</div>

<div class="form-group">
<label class="form-label">
ç”œåº¦ï¼ˆ1â€“5ï¼‰
</label>
<div class="range-wrapper">
<input type="range" id="sweet" min="1" max="5" value="3" />
<div class="range-value" id="sweetValue">3</div>
</div>
</div>

<div class="form-group">
<label class="form-label">
å†°å¡Šï¼ˆ1â€“5ï¼‰
</label>
<div class="range-wrapper">
<input type="range" id="ice" min="1" max="5" value="3" />
<div class="range-value" id="iceValue">3</div>
</div>
</div>

<div class="form-group">
<label class="form-label">
èŒ¶å‘³æ¿ƒåº¦ï¼ˆ1â€“5ï¼‰
</label>
<div class="range-wrapper">
<input type="range" id="tea" min="1" max="5" value="4" />
<div class="range-value" id="teaValue">4</div>
</div>
</div>

<div class="form-group">
<label class="form-label">
å›è³¼æ„é¡˜ï¼ˆ1â€“5ï¼‰
</label>
<div class="range-wrapper">
<input type="range" id="repurchase" min="1" max="5" value="4" />
<div class="range-value" id="repurchaseValue">4</div>
</div>
</div>

<div class="form-group form-row-span">
<label class="form-label">
å„ªé»äº®é»
<span class="label-tag">å¯ä»¥åˆ—å‡ºå¹¾å€‹é—œéµè©</span>
</label>
<textarea id="pros" placeholder="ä¾‹ï¼šèŒ¶å‘³å¾ˆé¦™ã€å¥¶å‘³é †å£ã€çç æœ‰åš¼å‹ã€ç”œåº¦å‰›å¥½â€¦"></textarea>
</div>

<div class="form-group form-row-span">
<label class="form-label">
å°ç¼ºé» / å‚™è¨»
</label>
<textarea id="cons" placeholder="ä¾‹ï¼šå†°å¡Šå¤ªå¤šã€åç”œã€ç­‰å¤ªä¹…ã€æ¯å­å®¹æ˜“æ¼â€¦"></textarea>
<div class="hint">æç¤ºï¼šå„ªé»èˆ‡ç¼ºé»æœƒä¸€èµ·é¡¯ç¤ºåœ¨å¡ç‰‡ä¸‹æ–¹ï¼Œæ–¹ä¾¿ä¹‹å¾Œå›é¡§ã€‚</div>
</div>

<button type="submit" class="btn-add">
<span class="icon">ğŸ§‹</span>
<span>åŠ å…¥é€™æ¯é£²æ–™</span>
</button>
</form>
</section>

<!
-å³å´ï¼šè©•æ¯”åˆ—è¡¨ -->
<section class="panel">
<div class="toolbar">
<div class="toolbar-left">
<div class="toolbar-title">
é£²æ–™è©•æ¯”ç¸½è¦½
<span class="pill-count" id="drinkCount">0 æ¯å·²è¨˜éŒ„</span>
</div>
</div>
<div class="toolbar-right">
<input
id="filterStore"
class="input-small"
type="text"
placeholder="ğŸ” æœå°‹åº—å®¶åç¨±"
/>
<select id="sortBy" class="select-small">
<option value="newest">æ’åºï¼šæœ€æ–°åœ¨å‰</option>
<option value="scoreDesc">æ’åºï¼šç¸½åˆ†é«˜ âœ ä½</option>
<option value="priceAsc">æ’åºï¼šåƒ¹æ ¼ä½ âœ é«˜</option>
<option value="priceDesc">æ’åºï¼šåƒ¹æ ¼é«˜ âœ ä½</option>
</select>
</div>
</div>
<div class="drink-list" id="drinkList">
<div class="empty-state">é‚„æ²’æœ‰ä»»ä½•é£²æ–™ç´€éŒ„ï¼Œå…ˆå¾å·¦é‚Šæ–°å¢ä¸€æ¯é–‹å§‹å§ ğŸ¥¤</div>
</div>

<div class="footer-note">
å°æé†’ï¼šè³‡æ–™åªæœƒå„²å­˜åœ¨ä½ çš„ç€è¦½å™¨ï¼Œä¸æœƒä¸Šå‚³åˆ°ç¶²è·¯ã€‚
</div>
</section>
</div>
</div>

<script>
const drinksKey = "myDrinkReviews_v1";

const form = document.getElementById("drinkForm");
const totalScoreRange = document.getElementById("totalScore");
const totalScoreValue = document.getElementById("totalScoreValue");
const sweetRange = document.getElementById("sweet");
const sweetValue = document.getElementById("sweetValue");
const iceRange = document.getElementById("ice");
const iceValue = document.getElementById("iceValue");
const teaRange = document.getElementById("tea");
const teaValue = document.getElementById("teaValue");
const repurchaseRange = document.getElementById("repurchase");
const repurchaseValue = document.getElementById("repurchaseValue");

const drinkListEl = document.getElementById("drinkList");
const drinkCountEl = document.getElementById("drinkCount");
const filterStoreInput = document.getElementById("filterStore");
const sortBySelect = document.getElementById("sortBy");

let drinks = [];

// åˆå§‹åŒ–ï¼šè¼‰å…¥ LocalStorage
function loadDrinks() {
try {
const saved = localStorage.getItem(drinksKey);
if (saved) {
drinks = JSON.parse(saved);
}
} catch (err) {
console.error("Failed to load drinks", err);
}
renderDrinks();
}

function saveDrinks() {
try {
localStorage.setItem(drinksKey, JSON.stringify(drinks));
} catch (err) {
console.error("Failed to save drinks", err);
}
}

// æ¸²æŸ“åˆ—è¡¨
function renderDrinks() {
const keyword = filterStoreInput.value.trim().toLowerCase();
const sortBy = sortBySelect.value;

let list = [...drinks];

if (keyword) {
list = list.filter(d =>
d.store.toLowerCase().includes(keyword)
);
}

// æ’åº
list.sort((a, b) => {
if (sortBy === "newest") {
return b.createdAt
a.createdAt;
} else if (sortBy === "scoreDesc") {
return b.totalScore
a.totalScore;
} else if (sortBy === "priceAsc") {
if (a.price == null && b.price == null) return 0;
if (a.price == null) return 1;
if (b.price == null) return -1;
return a.price
b.price;
} else if (sortBy === "priceDesc") {
if (a.price == null && b.price == null) return 0;
if (a.price == null) return 1;
if (b.price == null) return -1;
return b.price
a.price;
}
return 0;
});
drinkCountEl.textContent = drinks.length + " æ¯å·²è¨˜éŒ„";

if (!list.length) {
drinkListEl.innerHTML = '<div class="empty-state">æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„é£²æ–™ï¼Œæ›å€‹é—œéµå­—çœ‹çœ‹ï¼ŸğŸ¹</div>';
return;
}

drinkListEl.innerHTML = list.map(d => {
const sweetPercent = (d.sweet / 5) * 100;
const icePercent = (d.ice / 5) * 100;
const teaPercent = (d.tea / 5) * 100;
const repPercent = (d.repurchase / 5) * 100;

const priceLabel = d.price != null && d.price !== "" ? d.price + " å…ƒ" : "æœªè¨˜éŒ„";

return `
<article class="drink-card">
<div class="drink-header">
<div class="drink-store">
<span>${escapeHtml(d.store)}</span>
<span class="drink-name">${escapeHtml(d.drinkName)}</span>
</div>
<div class="score-badge">
<span>${d.totalScore}</span>
<small>/ 10</small>
</div>
</div>
<div class="drink-tags">
<span class="tag tag-price">åƒ¹æ ¼ï¼š${priceLabel}</span>
<span class="tag">å›è³¼æ„é¡˜ï¼š${d.repurchase}/5</span>
</div>
<div class="meter-row">
<div class="meter">
<div class="meter-label">
<span>ç”œåº¦</span>
<span>${d.sweet}/5</span>
</div>
<div class="meter-bar">
<div class="meter-fill" style="width:${sweetPercent}%;"></div>
</div>
</div>
<div class="meter">
<div class="meter-label">
<span>å†°å¡Š</span>
<span>${d.ice}/5</span>
</div>
<div class="meter-bar">
<div class="meter-fill" style="width:${icePercent}%;"></div>
</div>
</div>
<div class="meter">
<div class="meter-label">
<span>èŒ¶å‘³</span>
<span>${d.tea}/5</span>
</div>
<div class="meter-bar">
<div class="meter-fill" style="width:${teaPercent}%;"></div>
</div>
</div>
</div>
<div class="meter-row">
<div class="meter">
<div class="meter-label">
<span>å›è³¼</span>
<span>${d.repurchase}/5</span>
</div>
<div class="meter-bar">
<div class="meter-fill" style="width:${repPercent}%;"></div>
</div>
</div>
<div class="meter">
<div class="meter-label">
<span>è¨˜éŒ„æ™‚é–“</span>
<span>${formatTime(d.createdAt)}</span>
</div>
<div class="meter-bar">
<div class="meter-fill" style="width:100%;opacity:0.12;"></div>
</div>
</div>
</div>
<div class="pros-cons">
${d.pros ? `<div><strong>å„ªé»ï¼š</strong>${escapeHtml(d.pros)}</div>` : ""}
${d.cons ? `<div><strong>å°ç¼ºé»ï¼š</strong>${escapeHtml(d.cons)}</div>` : ""}
</div>
</article>
`;
}).join("");
}

// è½‰ç¾©é¿å… XSS
function escapeHtml(str) {
if (str == null) return "";
return String(str)
.replace(/&/g, "&amp;")
.replace(/</g, "&lt;")
.replace(/>/g, "&gt;")
.replace(/"/g, "&quot;")
.replace(/'/g, "&#39;");
}

function formatTime(ts) {
const d = new Date(ts);
const y = d.getFullYear();
const m = String(d.getMonth() + 1).padStart(2, "0");
const day = String(d.getDate()).padStart(2, "0");
const hh = String(d.getHours()).padStart(2, "0");
const mm = String(d.getMinutes()).padStart(2, "0");
return `${m}/${day} ${hh}:${mm}`;
}

// è¡¨å–®äº‹ä»¶
function setupRangeDisplay(rangeEl, displayEl) {
displayEl.textContent = rangeEl.value;
rangeEl.addEventListener("input", () => {
displayEl.textContent = rangeEl.value;
});
}

setupRangeDisplay(totalScoreRange, totalScoreValue);
setupRangeDisplay(sweetRange, sweetValue);
setupRangeDisplay(iceRange, iceValue);
setupRangeDisplay(teaRange, teaValue);
setupRangeDisplay(repurchaseRange, repurchaseValue);

form.addEventListener("submit", (e) => {
e.preventDefault();

const store = document.getElementById("store").value.trim();
const drinkName = document.getElementById("drinkName").value.trim();
const totalScore = Number(totalScoreRange.value);
const priceInput = document.getElementById("price").value.trim();
const sweet = Number(sweetRange.value);
const ice = Number(iceRange.value);
const tea = Number(teaRange.value);
const repurchase = Number(repurchaseRange.value);
const pros = document.getElementById("pros").value.trim();
const cons = document.getElementById("cons").value.trim();

if (!store || !drinkName) {
alert("è«‹è‡³å°‘è¼¸å…¥ã€Œåº—å®¶åç¨±ã€èˆ‡ã€Œé£²æ–™åç¨±ã€å”·ã€‚");
return;
}

const price = priceInput !== "" ? Number(priceInput) : null;

const newDrink = {
id: Date.now(),
store,
drinkName,
totalScore,
price,
sweet,
ice,
tea,
repurchase,
pros,
cons,
createdAt: Date.now()
};

drinks.push(newDrink);
saveDrinks();
renderDrinks();

form.reset();
totalScoreRange.value = 8;
totalScoreValue.textContent = "8";
sweetRange.value = 3;
sweetValue.textContent = "3";
iceRange.value = 3;
iceValue.textContent = "3";
teaRange.value = 4;
teaValue.textContent = "4";
repurchaseRange.value = 4;
repurchaseValue.textContent = "4";
});

filterStoreInput.addEventListener("input", () => {
renderDrinks();
});

sortBySelect.addEventListener("change", () => {
renderDrinks();
});

// åˆå§‹è¼‰å…¥
loadDrinks();
</script>
</body>
</html>
